# Hello World Good-bye Unit - 設計思想書 (Design Philosophy) v2.3

> **Architect**: Grandmaster Game Designer  
> **Last Updated**: 2025-11-28  
> **Status**: Active / Production

---

## 📜 0. ドキュメントガバナンス

このドキュメントは、本プロジェクトにおける**「唯一の真実（Single Source of Truth）」**です。
コードの実装やバランス調整において迷いが生じた場合、常に本ドキュメントの記述を優先します。

### 関連ファイル
*   **データ設計・バランス**: [`ITEMS_DESIGN.md`](./ITEMS_DESIGN.md) - アイテムと数値バランスの詳細。
*   **開発者向け指針**: [`AGENTS.md`](./AGENTS.md) - AIエージェントおよび開発者の行動規範。
*   **セットアップ**: [`TAURI_SETUP.md`](./TAURI_SETUP.md), [`docs/PWA_SETUP.md`](./docs/PWA_SETUP.md) - 環境構築。

---

## 🏛 1. ゲームコンセプト

### 1.1 テーマ
**「高専生の試験期間サバイバル」**
理不尽な難易度、迫りくる締切、削れる精神、そして単位への渇望。これらをリソース管理シミュレーションとして表現します。

### 1.2 コア・フィロソフィー: "60点の壁"
本作の難易度設計における中心概念です。
*   **0-59点**: 努力で到達可能。チュートリアル区間。
*   **60点 (合格ライン)**: 大きな壁。これを超えるには「ただの勉強」では足りない。
    *   過去問（情報の非対称性）
    *   カフェイン（寿命の前借り）
    *   人脈（政治力）
    これらを駆使して初めて到達できる領域として設計します。
*   **90点 (S評価)**: 運と戦略が噛み合った時のみ到達可能な「神の領域」。

### 1.3 体験の柱 (Experience Pillars)
1.  **焦燥感の演出**: 常に減り続けるリソース、不穏なBGM、グリッチノイズ。
2.  **選択の重み**: 「睡眠をとるか、エナドリで徹夜するか」「プライドを捨てて教授に媚びるか」。全ての選択にトレードオフを持たせる。
3.  **失敗の物語化**: 留年（ゲームオーバー）もまた一つのエンディングであり、笑い話（ログ）として楽しめるようにする。

---

## ⚙️ 2. ゲームシステム設計

### 2.1 リソース管理 (The 4 Pillars)
| リソース | 役割 | ゲームオーバー条件 | 備考 |
| :--- | :--- | :--- | :--- |
| **HP (体力)** | 行動コストの源泉 | **0 = 入院 (敗北)** | 低下すると学習効率ダウン |
| **SAN (精神)** | ストレス耐性 | **0 = 発狂 (敗北)** | <30で「狂気モード」発動 |
| **SATIETY (満腹)** | 行動キャパシティ | なし | 高すぎると効率低下 (Food Coma) |
| **CAFFEINE** | 効率ブースト剤 | なし (200上限) | 依存症・中毒デバフのリスクあり |

### 2.2 時間システム (Time Slots)
1日を7つのスロットに分割し、それぞれに「意味」を持たせます。
*   `MORNING` / `AM`: **学習ゴールデンタイム** (効率高)
*   `NOON`: **魔の時間** (眠気・満腹デバフ発生率高)
*   `AFTERNOON` / `AFTER_SCHOOL`: **イベント・講義**
*   `NIGHT`: **ラストスパート** (疲労蓄積)
*   `LATE_NIGHT`: **危険領域** (高効率だが、SAN減少・睡眠負債増大)

### 2.3 状態異常とバフ (Status Effects)
*   **睡眠負債**: 深夜活動で蓄積。解消しないと回復行動の効果が激減する。
*   **カフェイン中毒**: 摂取量150mg超で発動。毎ターンHP/SANダメージ。
*   **狂気 (Madness)**: SAN<30で発動。学習効率UPだが、HP消費増。破滅的な集中力。

---

## 🏗 3. アーキテクチャ設計

Feature-Sliced Design (FSD) の影響を受けた、関心の分離を徹底した構成です。

### 3.1 ディレクトリ構造マップ
```
src/
├── components/       # UI層 (View)
│   ├── ui/           # 汎用部品 (Button, Panel...)
│   └── status/       # ステータス表示系
├── logic/            # ロジック層 (Model/Controller)
│   ├── handlers/     # アクション別処理 (study, rest...)
│   ├── reducer.ts    # 状態遷移の中核
│   └── effectProcessor.ts # 副作用適用の一元管理
├── data/             # データ層 (Data)
│   ├── events/       # イベント定義 (JSON-like TS)
│   └── items.ts      # アイテム定義
├── config/           # 設定層 (Config)
│   └── gameBalance.ts # 全バランス定数
└── types/            # 型定義 (Types)
```

### 3.2 Effect Processor Pattern
ゲーム内のあらゆる状態変化（アイテム使用、イベント結果、学習成果）は、統一された `GameEventEffect` オブジェクトとして表現し、単一の `applyEffect` 関数で処理します。
これにより、**「何が起きたか」のログ生成を自動化・統一化**しています。

### 3.3 データ駆動設計
イベントやアイテムはTypeScriptファイルとして定義されていますが、構造はJSONに近く、ロジックから分離されています。これにより、将来的なDLC追加やMOD対応（外部JSON読み込み等）への拡張性を担保しています。

---

## 🛠 4. 拡張ロードマップ

### Phase 1: 基盤強化 (v2.x) - Current
- [x] Tauriによるデスクトップアプリ化
- [x] PWA対応（オフラインプレイ）
- [x] カフェイン・満腹度システムの刷新
- [ ] 60点ラインの視覚的マーカー実装

### Phase 2: 演出強化 (v3.0)
- [ ] Framer MotionによるリッチなUIアニメーション
- [ ] シェーダーを用いた背景エフェクト（雨、ノイズ）
- [ ] サウンドエンジンの強化（環境音のレイヤリング）

### Phase 3: コンテンツ拡張 (v4.0)
- [ ] マルチエンディング（就職、大学院、起業...）
- [ ] "After Story" DLC（研究室配属編）
- [ ] 実績システム (Achievements)

---

## 📝 5. バランス調整プロトコル

数値を変更する際は、以下のルールに従ってください。

1.  **ハードコード禁止**: 全て `config/gameBalance.ts` または `config/gameConstants.ts` に定義する。
2.  **ROI (投資対効果) の適正化**:
    *   高額アイテムは、その価格に見合う劇的な効果（時短、危機回避）を持たせること。
    *   「高いのに効果が薄い」アイテムは罠であり、プレイヤーの意欲を削ぐため徹底的に排除・修正する。
    *   目安: `価格 ÷ 100 ≒ スコア期待値`。リスクがある場合は価格を割引く。
3.  **テストプレイ**: 変更後は必ず `scripts/balance-report.ts` (概念的ツール) または手動プレイで「60点到達ターン数」を確認する。

---

> *"Code determines the rules, but Balance determines the fun."*